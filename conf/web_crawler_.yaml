web_crawler_conf:
  shared:
    search_client: "brave"
    top_k: 4
    user_agent: "crawlcadile (https://github.com/viktorho/crawlcadile.git)"

    chunk_config:
      chunking_strategy: regex
      params:
        patterns:
          - "(?<![A-Z]\\.[A-Z]\\.)(?<![A-Z][a-z]\\.)(?<=[.?!])\\s+"

    browser_config:
      headless: true

    crawler_config:
      wait_until: networkidle
      cache_mode: BYPASS
      page_timeout: 10000
      excluded_tags: ["nav", "footer", "form", "aside"]
      exclude_external_links: true
      remove_overlay_elements: true   #   <- shared “boiler-plate” rule

    llm_strategy:          # provider + runtime settings are global
      llm_config:
        provider: gemini/gemini-2.0-flash
        api_key_env: GEMINI_API_TOKEN
      extraction_type: block
      apply_chunking: true
      chunk_token_threshold: 2000
      overlap_rate: 0.1
      extra_args:
        temperature: 0.7
        max_tokens: 256
      input_format: html

  strategies:

    news:
      filters:
        - type: pruning
          min_word_threshold: 25
          link_density_threshold: 0.30
        - type: bm25
          query: "{user_query}"
          top_n: 3
      crawler_config:
        css_selector: "article, main"
      llm_strategy:
        instruction: |
          In this document, extract only the main body content of the article.
          Discard any navigation menus, advertisements, headers, footers,
          sidebars, scripts or boiler-plate text. Preserve paragraph breaks
          and headings up to level 3, and return the cleaned content as plain text.

    ecommerce:
      filters:
        - type: pruning
          min_word_threshold: 5
          link_density_threshold: 0.60
      crawler_config:
        css_selector: ".product-item, .product-card"
      llm_strategy:
        instruction: |
          Extract each product’s name, price and canonical URL.
          Ignore navigation, ads and promotion banners. Return a JSON list
          with keys: name, price, url.

    forum_thread:
      filters:
        - type: pruning
          min_word_threshold: 15
          link_density_threshold: 0.40
      crawler_config:
        css_selector: ".thread-content, .post-body"
      llm_strategy:
        instruction: |
          Return an array of posts, each with {author, timestamp, content}.
          Exclude signatures, quotes and sidebar widgets.